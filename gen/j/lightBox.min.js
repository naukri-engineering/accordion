!function(a){function b(b,d){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&c(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||d:d)&&c(b)}function c(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}a.expr[":"].focusable=function(c){return b(c,!isNaN(a.attr(c,"tabindex")))};var d={is_options_valid:function(a){return a&&a.ltBox&&1===a.ltBox.prop("nodeType")?!0:!1},is_animtion_support:function(){return null===window.navigator.userAgent.match(/MSIE (7|8|9)/)},switchClass:function(a,b){this.removeClass(a).addClass(b)}};a.fn.lightBox=function(b){var c=null;return d.is_options_valid(b)&&a.each(this,function(d,f){var g=a(f);c=new e(b,g),g.data("lt_Box",c)}),this.data("lt_Box")||c};var e=function(a,b){var c=b.data("lt_Box");c&&c.options.ltBox[0]===a.ltBox[0]&&c.reInit(),a.trigger=b,this.init(a)},f=function(){function b(){var b=999;return a(".ltCont .ltLayer").each(function(){var c=parseInt(a(this).css("z-index"));c>b&&(b=c)}),b}var c="lightBox",e={ltBox:null,dimens:{height:"auto",width:"auto"},resetForm:!1,fixed:!1,open:{success:function(){},event:"click",anim:{className:""}},close:{esc:!0,layer:!0,nodes:{target:"",event:"click",selector:""},success:function(){},returnFocus:!0,anim:{className:"",duration:0}}},f=function(){var b=a('<div class="ltCont close"></div>').attr("tabIndex",0),c=a('<div class="ltLayer close"></div>');return b.append(c),a(window).bind("resize",function(){try{if(f.stack.length){var a=f.stack[0];g.call(a)}}catch(b){}}),a("html").keydown(function(a){27===a.keyCode&&f.stack.length&&f.stack[0].options.close.esc&&f.stack[0].close()}),c.click(function(){f.stack.length&&f.stack[0].options.close.layer&&f.stack[0].close()}),{stack:[],cont:b,layer:c}}();a(function(){a("body").append(f.cont)}),a.fn.lightBox.close=function(a){var b,c;b=0,c=0,a=a||{},a.all&&(b=f.stack.length-1),a.allPrevious?(b=f.stack.length-1,c=1):a.index&&(c=b=a.index);for(var d=b;d>=c;d--)d in f.stack?f.stack[d].close(d,a.noAnim):""},a.fn.lightBox.closeAll=function(b){a.fn.lightBox.close(b||{all:!0})};var g=(function(){f.cont.keydown(function(a){if(f.stack.length&&9===a.keyCode){var b=f.stack[0].options.ltBox.find(":focusable"),c=b.first(),d=b.last();return a.target!==d[0]&&a.target!==a.currentTarget||a.shiftKey?a.target!==c[0]&&a.target!==a.currentTarget||!a.shiftKey?void a.stopPropagation():(d?d.focus():"",!1):(c?c.focus():"",!1)}}),a("html").keydown(function(a){return 9===a.keyCode&&f.stack.length?(f.cont.focus(),!1):void 0})}(),function(){a(".ltCont").css({width:"auto",height:"auto"});var b=document.documentElement||document.body,c=a(window).height(),d=a(document).height(),e=a(window).width(),g=a(document).width(),h=window.pageYOffset?pageYOffset:b.scrollTop,i=(window.pageXOffset?pageXOffset:b.scrollLeft,c-this.options.ltBox.height()),j=0,k=e-this.options.ltBox.width(),l=0;return i>0?j=(this.options.fixed?0:h)+i/2:(j=0,window.scrollTo(0,j)),l=k>0?k/2:0,f.cont.css({width:g+"px",height:d+"px"}),this.options.ltBox.css({top:j+"px",left:l+"px"}),!0}),h=function(){this.options.ltBox.css({position:this.options.fixed?"fixed":"absolute",width:this.options.dimens.width,height:this.options.dimens.height})},i=function(b){this.options=a.extend(!0,{},e,b)},j=function(){var a=this.options.ltBox.parent();a.hasClass("ltCont")||f.cont.append(this.options.ltBox)},k={open:function(){var a=[this.options.close.anim.className,this.options.open.anim.className];d.switchClass.call(this.options.ltBox,a[0],a[1])},close:function(a){var b=[this.options.close.anim.className,this.options.open.anim.className];d.switchClass.call(this.options.ltBox,b[1],b[0]);var c=0;d.is_animtion_support()&&(c=this.options.close.anim.duration),setTimeout(function(){a.cb()},c)}},l=function(){f.stack.length||(f.cont.removeClass("close"),d.switchClass.call(f.layer,"close","open")),n.call(this);var c=b();f.layer.css("zIndex",c+3),f.cont.css("zIndex",c+1),this.options.ltBox.css("zIndex",c+3),this.options.ltBox.addClass("lightbox_open"),g.call(this),k.open.call(this),m.call(this),-1===a.inArray(this,f.stack)&&f.stack.unshift(this),this.options.open.success()},m=function(){var a=document.documentElement.scrollTop,b=this.options.open.firstFocus;b?b.focus():f.cont.focus(),document.documentElement.scrollTop=a},n=function(){if(this.options.resetForm)for(var a=this.options.ltBox.find("form"),b=0;b<a.length;b++)a[b].reset()},o=function(b,c){{var e=this;f.stack}if(b=b||a(f.stack).index(this),f.stack.length&&!(0>b)){f.stack.splice(b,1);var h={cb:function(){if(e.options.ltBox.removeClass("lightbox_open"),f.stack.length){var a=f.stack[0];f.layer.css("zIndex",a.options.ltBox.css("zIndex")),g.call(a)}else f.cont.addClass("close");p.call(e),n.call(e),e.options.close.success()}};c?h.cb():k.close.call(this,h),f.stack.length||d.switchClass.call(f.layer,"open","close")}},p=function(){if(!f.stack.length){var b=this.options.close.returnFocus;b===!0?this.options.trigger.focus():a(b).focus()}},q=function(){var a=this;this.options.trigger.on(this.options.open.event+"."+c,function(){a.open()}),r.call(this,this.options.close.nodes)},r=function(b){var c=this;if("array"===a.type(b))return void a.each(b,function(a,b){r.call(c,b)});var d=null;b.constructor===jQuery?(d=a.extend({},e.close.nodes),d.target=b):d={target:a(b.target),event:b.event,selector:b.selector},d.target.on(d.event,d.selector,function(){c.close()})},s=function(a){i.call(this,a),j.call(this),h.call(this),q.call(this),this.options.ltBox.addClass(this.options.close.anim.className)},t=function(){this.options.trigger.off(this.options.open.event+"."+c)};return{init:s,reInit:t,resize:g,open:l,close:o}}();e.prototype=f}(jQuery);